
<div class="row">
<div class="col-md-12 grid-margin">
  <div class="card">
    <div class="card-body">
      <div class="row">
        <div class="col-lg-3 col-md-6">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold">32,451</h3>
              <h5 class="mb-0 font-weight-medium text-primary">Visits</h5>
              <p class="mb-0 text-muted">+14.00(+0.50%)</p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-1" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mt-md-0 mt-4">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold">15,236</h3>
              <h5 class="mb-0 font-weight-medium text-primary">Impressions</h5>
              <p class="mb-0 text-muted">+138.97(+0.54%)</p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-2" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mt-md-0 mt-4">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold">7,688</h3>
              <h5 class="mb-0 font-weight-medium text-primary">Conversation</h5>
              <p class="mb-0 text-muted">+57.62(+0.76%)</p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-3" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mt-md-0 mt-4">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold">1,553</h3>
              <h5 class="mb-0 font-weight-medium text-primary">Downloads</h5>
              <p class="mb-0 text-muted">+138.97(+0.54%)</p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-4" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<div class="row">
        <div class="col-md-6 p-1">
          <canvas id="myChart" width="400" height="200"></canvas>
        </div>
        <div class="col-md-6 p-1">
<div class="row">

      <!-- Grid column -->
      <div class="col-12 p-1">

        <div class="card grey lighten-2">
          <div class="card-body pb-0">
            <i class="fas fa-cloud fa-3x pb-4"></i>
            <div class="d-flex justify-content-between">
              <p class="mb-0 h6">Customers</p>
            </div>
          </div>
          <hr>
          <div class="card-body pt-0">
            <h6 class="font-weight-bold mb-1"># <%=@customers_count%></h6>
            <p class="mb-0">
              <a href="/admin/customers">show</a>
            </p>
          </div>
        </div>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-12 p-1">

        <div class="card grey lighten-3">
          <div class="card-body pb-0">
            <i class="fas fa-cloud fa-3x pb-4"></i>
            <div class="d-flex justify-content-between">
              <p class="mb-0 h6">Accounts</p>
            </div>
          </div>
          <hr>
          <div class="card-body pt-0">
            <h6 class="font-weight-bold mb-1"># <%=@accounts_count%></h6>
            <p class="mb-0">
              <a href="/admin/accounts">show</a>
            </p>
          </div>
        </div>

      </div>
      <!-- Grid column -->

    </div>        </div>

</div>

    <!-- Grid row -->

   
<div class="row mt-5">
    <div class="col">
        <canvas id="lastDays" height="120"></canvas>
    </div>
</div>

<div class="row mt-5">
  <div class="col-md-12">
    <div class="h5 text-center py-5">Today's Purchases</div>

<table class="table table-striped table-bordered">
        <thead class="thead-light">
                <tr class="bg-info">
                    <th>Customer</th>
                    <th>Plan</th>
                    <th>AccId</th>
                    <th>Purchased Date</th>
                    <th>Due Date</th>
                </tr>
            </thead>
            <tbody>
                <% @latest.each do |account| %>
                    <tr>
                        <td><%=account.customer.email %></td>
                        <td><%= account.plan.name %></td>
                        <td><%= account.acc_id %></td>
                        <td><%= account.created_at.strftime("%F") %></td>
                        <td><%= account.due_date.strftime("%F") %></td>
                    </tr>
    
                <% end %>
            </tbody>
        </table> 

  </div>
</div>

</div>
<script>
var ctx = document.getElementById('myChart');

new Chart(document.getElementById("lastDays"), {
  type: 'line',
  data: {
    labels: <%= raw @last_days.map {|d| d.first.strftime("%F") }.to_a %>,
    datasets: [{ 
        data: <%= raw @last_days.map {|d| d.last }.to_a%>,
        label: "Accounts",
        borderColor: "#3e95cd",
        fill: false
      }
    ]
  },
  options: {
    title: {
      display: true,
      text: 'Number of Accounts per day (last 30 days)'
    }
  }
});


new Chart(document.getElementById("myChart"), {
    type: 'pie',
    data: {
      labels: <%= raw @data.map {|d| d[:plan] }.to_a%>,
      datasets: [{
        label: "Population (millions)",
        backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
        data: <%= raw @data.map {|d| d[:count] }.to_a%>
      }]
    },
    options: {
      title: {
        display: true,
        text: 'Plan Purchased'
      }
    }
});
</script>