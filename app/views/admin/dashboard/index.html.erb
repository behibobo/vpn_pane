
<div class="row">
<div class="col-md-12 grid-margin">
  <div class="card">
    <div class="card-body">
      <div class="row">
        <div class="col-lg-3 col-md-6">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold"><%=@accounts_count%></h3>
              <h5 class="mb-0 font-weight-medium text-primary">Accounts</h5>
              <p class="mb-0 text-muted"><a href="/admin/accounts">details</a></p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-1" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mt-md-0 mt-4">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold"><%=@customers_count%></h3>
              <h5 class="mb-0 font-weight-medium text-primary">Customers</h5>
              <p class="mb-0 text-muted"><a href="/admin/customers">details</a></p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-2" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mt-md-0 mt-4">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold">7,688</h3>
              <h5 class="mb-0 font-weight-medium text-primary">Conversation</h5>
              <p class="mb-0 text-muted">+57.62(+0.76%)</p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-3" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mt-md-0 mt-4">
          <div class="d-flex">
            <div class="wrapper">
              <h3 class="mb-0 font-weight-semibold">1,553</h3>
              <h5 class="mb-0 font-weight-medium text-primary">Downloads</h5>
              <p class="mb-0 text-muted">+138.97(+0.54%)</p>
            </div>
            <div class="wrapper my-auto ml-auto ml-lg-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
              <canvas height="50" width="100" id="stats-line-graph-4" class="chartjs-render-monitor" style="display: block;"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<div class="row">
              <div class="col-md-8 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                  <div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
                    <h4 class="card-title mb-0">Sales Statistics Overview</h4>
                    
                    <canvas id="lastDays"></canvas>
                  </div>
                </div>
              </div>
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body d-flex flex-column"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
                    
                    <canvas class="my-auto mx-auto chartjs-render-monitor" id="myChart"></canvas>
                  </div>
                </div>
              </div>
            </div>


            <div class="row">
              <div class="col-md-12 grid-margin stretch-card">
                <div class="card">
                <div class="card-body d-flex flex-column"> <h4 class="card-title mb-20">Today's Purchases</h4>

<table class="table table-striped table-bordered">
        <thead class="thead-light">
                <tr class="bg-info">
                    <th>Customer</th>
                    <th>Plan</th>
                    <th>AccId</th>
                    <th>Purchased Date</th>
                    <th>Due Date</th>
                </tr>
            </thead>
            <tbody>
                <% @latest.each do |account| %>
                    <tr>
                        <td><%=account.customer.email %></td>
                        <td><%= account.plan.name %></td>
                        <td><%= account.acc_id %></td>
                        <td><%= account.created_at.strftime("%F") %></td>
                        <td><%= account.due_date.strftime("%F") %></td>
                    </tr>
    
                <% end %>
            </tbody>
        </table> 

  </div>
  </div>
</div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>  
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" ></script>
<script>
var ctx = document.getElementById('myChart');

new Chart(document.getElementById("lastDays"), {
  type: 'line',
  data: {
    labels: <%= raw @last_days.map {|d| d.first.strftime("%F") }.to_a %>,
    datasets: [{ 
        data: <%= raw @last_days.map {|d| d.last }.to_a%>,
        label: "Accounts",
        borderColor: "#3e95cd",
        fill: false
      }
    ]
  },
  options: {
    title: {
      display: true,
      text: 'Number of Accounts per day (last 30 days)'
    }
  }
});


new Chart(document.getElementById("myChart"), {
    type: 'pie',
    data: {
      labels: <%= raw @data.map {|d| d[:plan] }.to_a%>,
      datasets: [{
        label: "Population (millions)",
        backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
        data: <%= raw @data.map {|d| d[:count] }.to_a%>
      }]
    },
    options: {
      title: {
        display: true,
        text: 'Plan Purchased'
      }
    }
});
</script>